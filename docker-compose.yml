version: "3.1"

services:
    nginx:
        image: nginx:1.19.0
        volumes:
            - ./app/:/var/www/otaku-index/
            - ./.docker/nginx/otaku-index.conf/:/etc/nginx/conf.d/default.conf
        ports:
            - 8888:80
        depends_on:
            - php
        networks:
            - symfony
    php:
        build:
            context: ./.docker/php/
            dockerfile: dockerfile
        volumes:
            - ./app/:/var/www/otaku-index/
            - ./.docker/php/php.ini/:/usr/local/etc/php/php.ini
        networks:
            - symfony
        depends_on:
            - database
    database:
        image: postgres:13-alpine
        environment:
            POSTGRES_DB: otakuindex
            POSTGRES_USER: symfony
            POSTGRES_PASSWORD: symfony
        networks:
            - symfony
        ports:
            - 5432:5432

networks:
  symfony:
